clear all


A=[
    -0.0199,-0.0058,-0.0058,-0.0038,0.0059,0.0002,0,-0.1690;
    -0.0452,-0.0526,-0.0061,-0.0066,-0.0039,0.0038,0.1689,-0.0001;
    -0.0788,-0.0747,-0.3803,0.0002,-0.0012,0.0107,0.0058,0.0026;
    1.7937,-10.2118,-0.7034,-2.9979,-0.5308,0.4155,0,0;
    1.4517,0.7601,-0.69,0.071,-0.5943,0.0013,0,0;
    4.3058,2.8774,-0.1409,0.4058,0.4069,-0.4940,0,0;
    0,0,0,1,0.0005,0.0154,0,0;
    0,0,0,0,0.9994,0.0343,0,0
];


B=[
    -0.0257,-0.0048,0.1604,-0.0004;
    -0.0208,0.1617,0.0029,0.0989;
    -1.7572,-0.0019,0.0026,0.0001;
    -5.3869,47.6176,1.3595,9.9355;
    -0.7122,0.5801,-8.4439,-0.0701;
    12.8642,-5.9904,3.1776,-11.9896;
    0,0,0,0;
    0,0,0,0
];

A1d=[
    -0.0199,0,0,0,0,0,0,-0.169;
    0,-0.0526,0,0,0,0,0.1689,0;
    0,0,-4,0,0,0,0,0;
    0,0,0,-4,0,0,0,0;
    0,0,0,0,-4,0,0,0;
    0,0,0,0,0,-4,0,0;
    0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0;
];



B1d=[
    0,0,0,0;
    0,0,0,0;
    4,0,0,0;
    0,4,0,0;
    0,0,4,0;
    0,0,0,4;
    0,0,0,0;
    0,0,0,0;
];

K1=inv((B'*B))*B'*(A-A1d);
H1=inv(B'*B)*B'*B1d;


A2d=[
    -0.0199,0,0,0,0,0,0,-0.169;
    0,-0.0526,0,0,0,0,0.1689,0;
    0,0,-2,0,0,0,0,0;
    0,0,0,-3.26634,0,0,-5.3361,0;
    0,0,0,0,-3.26634,0,0,-5.3361;
    0,0,0,0,0,-2,0,0;
    0,0,0,1,0,0,0,0;
    0,0,0,0,1,0,0,0;
];

B2d=[
    0,0,0,0;
    0,0,0,0;
    2,0,0,0;
    0,2.66805,0,0;
    0,0,2.66805,0;
    0,0,0,2;
    0,0,0,0;
    0,0,0,0
];

u1=[0;0;0;5.3361;5.3361;0;0;0];

K2=inv((B'*B))*B'*(A-A2d);
H2=inv(B'*B)*B'*B2d;

B_inv=inv(B'*B)*B';



collective=0;%%%%%%%%%%%%
lateral=0;
longtudinal=1;
pedal=0;



run AFCS_1
sim AFCS_1
u=y(:,1);
v=y(:,2);
w=y(:,3);
p=y(:,4);
q=y(:,5);
r=y(:,6);
roll_angle=y(:,7);
pitch_angle=y(:,8);
figure

subplot(10,1,1) 
plot(t,u)
legend('u')

subplot(10,1,2)
plot(t,v)
legend('v')

subplot(10,1,3)
plot(t,w)
legend('w')

subplot(10,1,4)
plot(t,p)
legend('p')

subplot(10,1,5)
plot(t,q)
legend('q')

subplot(10,1,6)
plot(t,r)
legend('r')

subplot(10,1,7)
plot(t,roll_angle)
legend('roll angle')

subplot(10,1,8)
plot(t,pitch_angle)
legend('pitch angle')

subplot(10,1,9)
plot(t,yaw_angle)
legend('yaw angle')

subplot(10,1,10)
plot(t,height)
legend('height')



